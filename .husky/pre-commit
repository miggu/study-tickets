staged_files="$(git diff --cached --name-only --diff-filter=ACM)"
if [ -z "$staged_files" ]; then
  exit 0
fi

matched_files=""
for file in $staged_files; do
  if git diff --cached -U0 -- "$file" | rg "^\+.*console\.(log|debug|info|warn|error)\b" >/dev/null; then
    matched_files="${matched_files}${file}\n"
  fi
done

if [ -n "$matched_files" ]; then
  echo "Error: console statements found in staged changes."
  printf "Files:\n%b" "$matched_files"
  echo "Remove them before committing."
  exit 1
fi
